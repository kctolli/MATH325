---
title: "Chocolate"
subtitle: "Kruskal-Wallis Test"
---

```{r, include=FALSE}
# Be sure to use your file menus at the top of R-Studio to:
# "Session -> Set working directory -> To source file location"
# Then play this chunk and the next one to get the data into R.
library(mosaic)
library(car)
library(DT)
library(pander)
library(tidyverse)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
choc <- read_csv("../Data/Chocolate.csv") %>% 
  mutate(Cocao = as.factor(as.character(Cocao)))
```

```{r, eval=FALSE}
getwd()
View(choc)
```

<!-- ---- -->

<!-- Instructions:

 Use the Chocolate dataset and a Kruskal-Wallis Test(s) to answer an interesting question(s) that you come up with.
 
 About the dataset:
 
  * Company: Name of the company manufacturing the bar.

  * Orig: The specific geo-region of origin for the bar.

  * Review: Date of publication of the review.

  * Cocoa: Cocoa percentage (darkness) of the chocolate bar being reviewed.

  * Location: Manufacturer base country.

  * Rating: Expert rating for the bar.
      5= Elite (Transcending beyond the ordinary limits)
      4= Premium (Superior flavor development, character and style)
      3= Satisfactory(3.0) to praiseworthy(3.75) (well made with special qualities)
      2= Disappointing (Passable but contains at least one significant flaw)
      1= Unpleasant (mostly unpalatable)

   * Type: The variety (breed) of cocoa bean used, if provided.
   
   * BroadOrig: The broad geo-region of origin for the bean.

Note this dataset and description come from: © 2018 Kaggle Inc for further details visit:

[Kaggle.com](https://www.kaggle.com/rtatman/chocolate-bar-ratings/data)


If you want to give your critiquers some ideas about what you have questions on and would like help with, place those details here.-->
<!-- **Comments to Critiquers:**  -->



<!--End your comments to your critiquers before this line.-->

<!-- ---- -->

<!--Begin writing your Analysis after this point.-->

<!-- ## Background {.tabset .tabset-fade} -->

## Hypothesis

The test done using Kruskal-Wallis. Typically, the hypotheses of the Kruskal-Wallis test are:

$$
  H_0: \text{All samples are from the same distribution.}
$$


$$
  H_a: \text{At least one sample's distribution is stochastically different.}
$$

However, according to the original authors, what the alternative to the Kruskal-Wallis test really is, “is a tendency for observations in at least one of the populations to be larger (or smaller) than all the observations together, when paired randomly. In many cases, this is practically equivalent to the mean of at least one population differing from the others.” Thus, it could also be appropriate to use the ANOVA style hypotheses

$$
  H_0: \mu_\text{Rating} = \mu_\text{Cocao} = \mu
$$

$$
  H_a: \mu_\text{Rating} \neq \mu_\text{Cocao}
$$


## Data Analysis {.tabset .tabset-fade}

### Basic Statistics

```{r}
pander(favstats(Rating ~ Cocao, data = choc)[,-10])
```

### Kruskal-Wallis Test

```{r}
mykruskal <- kruskal.test(Rating ~ Cocao, data=choc)
pander(mykruskal)
```

```{r}
boxplot(Rating ~ Cocao, data=choc, type=c("p","a"), col='grey', xlab="Percent of Cocoa", ylab="Rating of Chocolate", main="Rating vs Percent Cocoa")
```

### ANOVA Test

```{r}
myaov <- aov(Rating ~ Cocao, data=choc)
pander(myaov)
```

```{r message=FALSE, warning=FALSE}
par(mfrow = c(1,2))
plot(myaov, which=1:2)
```

### The Data

```{r, out.width=300}
pander(choc, split.tables = Inf)
```

## Interpretation

In this analysis I compared the percent of cocoa to rating of chocolate. 

Rating is on a 1 to 5 scale. 

    5 = Elite 
    4 = Premium 
    3 = Satisfactory
    2 = Disappointing 
    1 = Unpleasant  

Between 60% and 75% has the greatest rating. The highest rating is 70% cocoa and the highest average rating is 69%. 53% cocoa has the lowest rating. We can learn the frequency of the chocolate rating from the below graph. 

```{r}
hist(choc$Rating, breaks=15, col='sandybrown', xlab="Rating of Chocolate", main="Chocolate Rating")
```